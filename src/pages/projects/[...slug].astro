---
import { getCollection } from "astro:content";
import Base from "../../layouts/Base.astro";

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((project) => {
    return {
      params: { slug: project.slug },
      props: { project: project },
    };
  });
}

const { project } = Astro.props;
const { Content, headings } = await project.render();
---

<Base
  title={project.data.name}
  description={project.data.description}
  img={{
    src: project.data.cover.src,
    alt: project.data.cover.alt,
  }}
  type="article"
>
  <section>
    <ul>
      {
        headings.map((heading) => (
          <li>
            <a href={`#${heading.slug}`}>{heading.text}</a>
          </li>
        ))
      }
    </ul>
  </section>

  <article
    class="prose prose-neutral md:prose-lg lg:prose-xl dark:prose-invert prose-img:rounded-md"
  >
    <p class="lead">{project.data.description}</p>
    <Content />
    <a href="/projects">See other projects</a>
  </article>
</Base>
